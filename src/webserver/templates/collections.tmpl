{{template "header.tmpl" .}}
<section class="section">
  <div class="container">
    <h1 class="title">
      Collections
    </h1>
    <div>
    <button id='refresh'>Refresh</button>
    </div>
    <!-- <hr/>
    {{ .collectionsOverallSblock }}
    <hr/> -->
    <table border = 1 bordercolor = grey align = left>
      <tr>
          <th>Collection</th>
          <th>Status</th>
          <th>Details</th>
          <th>Status flow details</th>
      </tr>
      {{range .collectionsOverallSblock}}
      <tr>
        <td><a href="/collection/{{.Name}}" target="_blank" rel="noopener noreferrer">{{.Name}}</a></th>
        <td>{{.LatestUpdateStatus}}</th>
        <td><small><pre>{{.LatestUpdateStatusInfo}}</pre></small></th>
        <td>
          {{- if ne .LatestUpdateStatus "Completed" -}}
          <uml>{{.LatestUpdateUml}}</uml>
          {{- else -}}
          <umllink>{{.LatestUpdateUml}}</umllink>
          {{- end -}}
          </td>
      </tr>
      {{end}}
    </table>

  </div>
</section>
<script>
  document.getElementById('refresh').addEventListener('click',function() {    
    location.reload();
  });
</script>

<!-- plantUml -->
<!-- https://jsfiddle.net/jmnote/0a41frk9/ -->

    <!-- 
    <script src="//code.jquery.com/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery.min.js"></script> 
    -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="//cdn.rawgit.com/jmnote/plantuml-encoder/d133f316/dist/plantuml-encoder.min.js"></script>
    <script>
    $("uml").each(function() {
      var src = "//www.plantuml.com/plantuml/img/" + window.plantumlEncoder.encode( $(this).text() )
      $(this).replaceWith(
        $('<a>').attr('href', src).attr('target','_blank').attr('rel','noopener noreferrer').append(
          $('<img>').attr('src', src).attr('style','height:64px')
        )
      );
    });
    $("umllink").each(function() {
      var src = "//www.plantuml.com/plantuml/img/" + window.plantumlEncoder.encode( $(this).text() )
      $(this).replaceWith($('<a>').attr('href', src).attr('target','_blank').attr('rel','noopener noreferrer').text('open diagram in new tab'));
    });
    </script>



{{template "footer.tmpl"}}
